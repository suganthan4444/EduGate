{"ast":null,"code":"import React,{useState,useEffect}from'react';import api from'./api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminLearners(){const[learnerCourses,setLearnerCourses]=useState([]);const[csrfToken,setCsrfToken]=useState('');useEffect(()=>{async function fetchCsrfToken(){try{const response=await api.get('/get-learner-csrf-token/');setCsrfToken(response.data.csrfToken);}catch(error){console.error('Error fetching CSRF token:',error);}}fetchCsrfToken();},[]);useEffect(()=>{fetchLearnerCourses();},[]);const fetchLearnerCourses=async()=>{try{const response=await api.get('/api/get-learner-courses/');const data=response.data;if(!data.success){throw new Error('Failed to fetch learner courses');}setLearnerCourses(data.data.filter(course=>!course.course_purchase_status));}catch(error){console.error('Error fetching learner courses:',error.message);}};const grantCourse=async(learnerId,courseId)=>{try{const response=await api.patch(`/api/grant-course/${learnerId}/${courseId}/`,{method:'PATCH',headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken// Fetch CSRF token from cookies\n}});if(!response.ok){throw new Error('Failed to grant course');}alert('Course granted successfully');await fetchLearnerCourses();// Refresh learner courses after granting\n}catch(error){console.error('Error granting course:',error.message);alert('Failed to grant course');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Learners Course Requests\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Learner Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Learner ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Course ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Course Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Educator ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Educator Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:learnerCourses.map(course=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:course.learner_name}),/*#__PURE__*/_jsx(\"td\",{children:course.learner_id}),/*#__PURE__*/_jsx(\"td\",{children:course.course_id}),/*#__PURE__*/_jsx(\"td\",{children:course.course_name}),/*#__PURE__*/_jsx(\"td\",{children:course.educator_id}),/*#__PURE__*/_jsx(\"td\",{children:course.educator_name}),/*#__PURE__*/_jsx(\"td\",{children:course.course_price}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>grantCourse(course.learner_id,course.course_id),children:\"Grant Course\"})})]},course.course_id))})]})]});}export default AdminLearners;","map":{"version":3,"names":["React","useState","useEffect","api","jsx","_jsx","jsxs","_jsxs","AdminLearners","learnerCourses","setLearnerCourses","csrfToken","setCsrfToken","fetchCsrfToken","response","get","data","error","console","fetchLearnerCourses","success","Error","filter","course","course_purchase_status","message","grantCourse","learnerId","courseId","patch","method","headers","ok","alert","children","map","learner_name","learner_id","course_id","course_name","educator_id","educator_name","course_price","onClick"],"sources":["D:/Sugu/Study Zone/Coding/Code/Projects/Coapps/Final Project/Project EduGate/react-project/src/AdminLearners.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport api from './api';\r\n\r\nfunction AdminLearners() {\r\n    const [learnerCourses, setLearnerCourses] = useState([]);\r\n    const [csrfToken, setCsrfToken] = useState('');\r\n\r\nuseEffect(() => {\r\n    async function fetchCsrfToken() {\r\n        try {\r\n            const response = await api.get('/get-learner-csrf-token/');\r\n            setCsrfToken(response.data.csrfToken);\r\n        } catch (error) {\r\n            console.error('Error fetching CSRF token:', error);\r\n        }\r\n    }\r\n\r\n    fetchCsrfToken();\r\n}, []);\r\n\r\n    useEffect(() => {\r\n        fetchLearnerCourses();\r\n    }, []);\r\n\r\n    const fetchLearnerCourses = async () => {\r\n      try {\r\n          const response = await api.get('/api/get-learner-courses/');\r\n          const data = response.data;\r\n          if (!data.success) {\r\n              throw new Error('Failed to fetch learner courses');\r\n          }\r\n          setLearnerCourses(data.data.filter(course => !course.course_purchase_status));\r\n      } catch (error) {\r\n          console.error('Error fetching learner courses:', error.message);\r\n      }\r\n  };\r\n  \r\n  const grantCourse = async (learnerId, courseId) => {\r\n      try {\r\n          const response = await api.patch(`/api/grant-course/${learnerId}/${courseId}/`, {\r\n              method: 'PATCH',\r\n              headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'X-CSRFToken': csrfToken // Fetch CSRF token from cookies\r\n              }\r\n          });\r\n          if (!response.ok) {\r\n              throw new Error('Failed to grant course');\r\n          }\r\n          alert('Course granted successfully');\r\n          await fetchLearnerCourses(); // Refresh learner courses after granting\r\n      } catch (error) {\r\n          console.error('Error granting course:', error.message);\r\n          alert('Failed to grant course');\r\n      }\r\n  };\r\n\r\n    return (\r\n        <div>\r\n            <h1>Learners Course Requests</h1>\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th>Learner Name</th>\r\n                        <th>Learner ID</th>\r\n                        <th>Course ID</th>\r\n                        <th>Course Name</th>\r\n                        <th>Educator ID</th>\r\n                        <th>Educator Name</th>\r\n                        <th>Price</th>\r\n                        <th>Action</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {learnerCourses.map(course => (\r\n                        <tr key={course.course_id}>\r\n                            <td>{course.learner_name}</td>\r\n                            <td>{course.learner_id}</td>\r\n                            <td>{course.course_id}</td>\r\n                            <td>{course.course_name}</td>\r\n                            <td>{course.educator_id}</td>\r\n                            <td>{course.educator_name}</td>\r\n                            <td>{course.course_price}</td>\r\n                            <td>\r\n                                <button onClick={() => grantCourse(course.learner_id, course.course_id)}>\r\n                                    Grant Course\r\n                                </button>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AdminLearners;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}